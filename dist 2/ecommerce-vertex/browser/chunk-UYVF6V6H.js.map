{
  "version": 3,
  "sources": ["src/app/core/services/firestore.service.ts"],
  "sourcesContent": ["import { Injectable, inject, Injector, runInInjectionContext } from '@angular/core';\nimport { Firestore, collectionData, docData } from '@angular/fire/firestore';\nimport {\n  collection,\n  doc,\n  addDoc,\n  updateDoc,\n  deleteDoc,\n  DocumentReference,\n  UpdateData,\n  WithFieldValue,\n} from 'firebase/firestore';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { convertTimestampsToDates } from '@core/utils/date-converter';\n\ninterface BaseEntity {\n  id?: string;\n}\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class FirestoreService<T extends BaseEntity> {\n  private firestore: Firestore = inject(Firestore);\n  private injector = inject(Injector);\n\n  getAll(path: string): Observable<T[]> {\n    return runInInjectionContext(this.injector, () => {\n      const collectionRef = collection(this.firestore, path);\n      return (collectionData(collectionRef, { idField: 'id' }) as Observable<any[]>).pipe(\n        map(items => items.map(item => convertTimestampsToDates(item) as T))\n      );\n    });\n  }\n\n  get(path: string, id: string): Observable<T | undefined> {\n    return runInInjectionContext(this.injector, () => {\n      const documentRef = doc(this.firestore, `${path}/${id}`);\n      return (docData(documentRef, { idField: 'id' }) as Observable<any | undefined>).pipe(\n        map(item => (item ? (convertTimestampsToDates(item) as T) : undefined))\n      );\n    });\n  }\n\n  create(path: string, data: WithFieldValue<Omit<T, 'id'>>): Promise<DocumentReference<T>> {\n    const collectionRef = collection(this.firestore, path);\n    return addDoc(collectionRef, data) as Promise<DocumentReference<T>>;\n  }\n\n  update(path: string, id: string, data: Partial<T>): Promise<void> {\n    const documentRef = doc(this.firestore, `${path}/${id}`);\n    return updateDoc(documentRef, data as UpdateData<T>);\n  }\n\n  delete(path: string, id: string): Promise<void> {\n    const documentRef = doc(this.firestore, `${path}/${id}`);\n    return deleteDoc(documentRef);\n  }\n}"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;AAuBM,IAAO,mBAAP,MAAO,kBAAgB;EACnB,YAAuB,OAAO,SAAS;EACvC,WAAW,OAAO,QAAQ;EAElC,OAAO,MAAY;AACjB,WAAO,sBAAsB,KAAK,UAAU,MAAK;AAC/C,YAAM,gBAAgB,WAAW,KAAK,WAAW,IAAI;AACrD,aAAQ,eAAe,eAAe,EAAE,SAAS,KAAI,CAAE,EAAwB,KAC7E,IAAI,WAAS,MAAM,IAAI,UAAQ,yBAAyB,IAAI,CAAM,CAAC,CAAC;IAExE,CAAC;EACH;EAEA,IAAI,MAAc,IAAU;AAC1B,WAAO,sBAAsB,KAAK,UAAU,MAAK;AAC/C,YAAM,cAAc,IAAI,KAAK,WAAW,GAAG,IAAI,IAAI,EAAE,EAAE;AACvD,aAAQ,QAAQ,aAAa,EAAE,SAAS,KAAI,CAAE,EAAkC,KAC9E,IAAI,UAAS,OAAQ,yBAAyB,IAAI,IAAU,MAAU,CAAC;IAE3E,CAAC;EACH;EAEA,OAAO,MAAc,MAAmC;AACtD,UAAM,gBAAgB,WAAW,KAAK,WAAW,IAAI;AACrD,WAAO,OAAO,eAAe,IAAI;EACnC;EAEA,OAAO,MAAc,IAAY,MAAgB;AAC/C,UAAM,cAAc,IAAI,KAAK,WAAW,GAAG,IAAI,IAAI,EAAE,EAAE;AACvD,WAAO,UAAU,aAAa,IAAqB;EACrD;EAEA,OAAO,MAAc,IAAU;AAC7B,UAAM,cAAc,IAAI,KAAK,WAAW,GAAG,IAAI,IAAI,EAAE,EAAE;AACvD,WAAO,UAAU,WAAW;EAC9B;;qCAnCW,mBAAgB;EAAA;4EAAhB,mBAAgB,SAAhB,kBAAgB,WAAA,YAFf,OAAM,CAAA;;;sEAEP,kBAAgB,CAAA;UAH5B;WAAW;MACV,YAAY;KACb;;;",
  "names": []
}
